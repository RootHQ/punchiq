{"ast":null,"code":"import { ActivatedRoute, Router } from '@angular/router';\nimport { AuthService } from '../../services/auth.service';\nimport { MatDialog } from '@angular/material/dialog';\nimport { jwtDecode } from 'jwt-decode';\nimport { MissedPunchDialogComponent } from '../missed-punch-dialog/missed-punch-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/auth.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction PunchComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.error);\n  }\n}\nlet PunchComponent = /*#__PURE__*/(() => {\n  class PunchComponent {\n    authService;\n    route;\n    router;\n    dialog;\n    companyId = '';\n    employeeId = '';\n    employeeName = '';\n    typeBreak = '';\n    pin = '';\n    error = '';\n    companyName = '';\n    punchInTime = '';\n    breakStartTime = '';\n    breakEndTime = '';\n    punchOutTime = '';\n    constructor(authService, route, router, dialog) {\n      this.authService = authService;\n      this.route = route;\n      this.router = router;\n      this.dialog = dialog;\n    }\n    ngOnInit() {\n      this.route.paramMap.subscribe(params => {\n        this.companyId = params.get('companyId') || '';\n      });\n      this.route.queryParams.subscribe(() => {\n        const token = this.authService.getToken();\n        if (token) {\n          const payload = jwtDecode(token);\n          const exp = payload.exp * 1000;\n          const currentTime = Date.now();\n          const minutesLeft = (exp - currentTime) / (1000 * 60);\n          if (minutesLeft > 0 && minutesLeft <= 5) {\n            // this.dialog.open(SessionExpirationDialogComponent, {\n            //   data: { minutes: Math.floor(minutesLeft) },\n            //  width: '400px'\n            // });\n          }\n          if (currentTime >= exp) {\n            this.authService.logout();\n            this.router.navigate(['/' + this.companyId + '/login'], {\n              queryParams: {\n                expired: true\n              }\n            });\n            return;\n          }\n          this.employeeId = payload.sub || '';\n          this.employeeName = payload.empName || '';\n          this.pin = atob(payload.pin_encrypted || '');\n          this.companyName = payload.company_id || '';\n          this.typeBreak = localStorage.getItem('punch_status') || '';\n          // New Time Fields\n          this.punchInTime = payload.punch_in_time || '';\n          this.breakStartTime = payload.break_start_time || '';\n          this.breakEndTime = payload.break_end_time || '';\n          this.punchOutTime = payload.punch_out_time || '';\n          console.log('punchInTime:', this.punchInTime);\n          console.log('breakStartTime:', this.breakStartTime);\n          console.log('breakEndTime:', this.breakEndTime);\n          console.log('punchOutTime:', this.punchOutTime);\n          // Persist to localStorage if needed\n          localStorage.setItem('employee_id', this.employeeId);\n          localStorage.setItem('employee_name', this.employeeName);\n          localStorage.setItem('pin', this.pin);\n          localStorage.setItem('company_name', this.companyName);\n        } else {\n          this.authService.logout();\n          this.router.navigate(['/' + this.companyId + '/login'], {\n            queryParams: {\n              expired: true\n            }\n          });\n        }\n      });\n    }\n    onMissedPunch() {\n      const dialogRef = this.dialog.open(MissedPunchDialogComponent, {\n        data: {\n          lastPunchTime: '7:03'\n        },\n        width: '400px'\n      });\n      dialogRef.afterClosed().subscribe(result => {\n        if (result === 'confirm') {\n          console.log('Missed Punch Confirmed');\n        } else {\n          console.log('Missed Punch Canceled');\n        }\n      });\n    }\n    onPunch() {\n      const punchData = {\n        employee_id: this.employeeId,\n        pin: this.pin,\n        company_id: this.companyId,\n        ip_address: '',\n        local_time: new Date().toISOString()\n      };\n      fetch('https://api.ipify.org?format=json').then(response => response.json()).then(data => {\n        punchData.ip_address = data.ip;\n        // this.authService.sendPunch(punchData)...\n      }).catch(error => {\n        this.error = 'Unable to get IP address.';\n      });\n    }\n    onLogout() {\n      this.authService.logout();\n      this.router.navigate(['/' + this.companyId + '/login']);\n    }\n    static ɵfac = function PunchComponent_Factory(t) {\n      return new (t || PunchComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.MatDialog));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: PunchComponent,\n      selectors: [[\"app-punch\"]],\n      decls: 37,\n      vars: 5,\n      consts: [[1, \"header\"], [1, \"logo\"], [1, \"logout\", 3, \"click\"], [1, \"login-container\"], [1, \"login-box\"], [1, \"description\"], [1, \"form\", 3, \"ngSubmit\"], [\"for\", \"employeeId\", 1, \"label\"], [\"type\", \"text\", \"id\", \"employeeId\", \"name\", \"employeeId\", \"disabled\", \"\", 1, \"input_disabled\", 3, \"value\"], [\"for\", \"pin\", 1, \"label\"], [\"type\", \"text\", \"id\", \"pin\", \"name\", \"pin\", \"disabled\", \"\", 1, \"input_disabled\", 3, \"value\"], [1, \"space-top\"], [\"class\", \"error\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"btn-login\", \"topSpace\", \"punchDays\"], [\"type\", \"submit\", 1, \"btn-login\", \"topSpace\", \"punchOutbtn\"], [1, \"divider\"], [1, \"btn-login\", \"topSpace\", \"Logoutbtn\", 3, \"click\"], [1, \"missed-punch\", 3, \"click\"], [1, \"text_color\", \"textServices\"], [1, \"servicesrootimg\"], [1, \"error\"]],\n      template: function PunchComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵelement(1, \"div\", 1);\n          i0.ɵɵelementStart(2, \"a\", 2);\n          i0.ɵɵlistener(\"click\", function PunchComponent_Template_a_click_2_listener() {\n            return ctx.onLogout();\n          });\n          i0.ɵɵtext(3, \"Logout\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(4, \"div\", 3)(5, \"div\", 4)(6, \"h2\");\n          i0.ɵɵtext(7);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"p\", 5);\n          i0.ɵɵtext(9, \"Select your punch choice below.\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(10, \"form\", 6);\n          i0.ɵɵlistener(\"ngSubmit\", function PunchComponent_Template_form_ngSubmit_10_listener() {\n            return ctx.onPunch();\n          });\n          i0.ɵɵelementStart(11, \"label\", 7);\n          i0.ɵɵtext(12, \"Employee ID\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(13, \"input\", 8);\n          i0.ɵɵelementStart(14, \"label\", 9);\n          i0.ɵɵtext(15, \"Pin\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(16, \"input\", 10);\n          i0.ɵɵelementStart(17, \"div\", 11);\n          i0.ɵɵtemplate(18, PunchComponent_div_18_Template, 2, 1, \"div\", 12);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"button\", 13);\n          i0.ɵɵtext(20, \"Punch In\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(21, \"button\", 14);\n          i0.ɵɵtext(22, \"Punch Out for the Day\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"div\", 15);\n          i0.ɵɵtext(24, \"OR\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(25, \"button\", 16);\n          i0.ɵɵlistener(\"click\", function PunchComponent_Template_button_click_25_listener() {\n            return ctx.onLogout();\n          });\n          i0.ɵɵtext(26, \"Logout\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(27, \"br\")(28, \"br\")(29, \"br\")(30, \"br\")(31, \"br\");\n          i0.ɵɵelementStart(32, \"a\", 17);\n          i0.ɵɵlistener(\"click\", function PunchComponent_Template_a_click_32_listener() {\n            return ctx.onMissedPunch();\n          });\n          i0.ɵɵtext(33, \"Missed Punch\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(34, \"div\", 18);\n          i0.ɵɵelement(35, \"div\", 19);\n          i0.ɵɵtext(36, \" Service by Root\");\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(7);\n          i0.ɵɵtextInterpolate2(\"Hey \", ctx.employeeName, \" \", ctx.typeBreak, \" \");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"value\", ctx.employeeId);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"value\", ctx.pin);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n        }\n      },\n      dependencies: [i4.NgIf, i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.NgForm],\n      styles: [\"var[_ngcontent-%COMP%]   resource[_ngcontent-%COMP%]; (()[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] >  {// webpackBootstrap var __webpack_modules__ = ({966: (() => {throw new Error(\\\"Module build failed (from ./node_modules/postcss-loader/dist/cjs.js):nnSyntaxErrornn(147:3) C:\\\\\\\\Users\\\\\\\\USUARIO\\\\\\\\OneDrive\\\\\\\\Documents\\\\\\\\Repo\\\\\\\\punch-iq-project-full\\\\\\\\punch-iq-project\\\\\\\\frontend\\\\\\\\src\\\\\\\\app\\\\\\\\pages\\\\\\\\punch\\\\\\\\punch.component.css Unknown wordnn u001b[90m 145 | u001b[39m    cursoru001b[33m:u001b[39m pointeru001b[33m;u001b[39mn u001b[90m 146 | u001b[39m  u001b[33m}u001b[39mnu001b[1mu001b[31m>u001b[39mu001b[22mu001b[90m 147 | u001b[39m  u001b[36murlu001b[39mu001b[36m(../break/break.component.css)u001b[39mn u001b[90m     | u001b[39m  u001b[1mu001b[31m^u001b[39mu001b[22mn\\\");})})[_ngcontent-%COMP%]; //[_ngcontent-%COMP%]   startup[_ngcontent-%COMP%]   //[_ngcontent-%COMP%]   Load[_ngcontent-%COMP%]   entry[_ngcontent-%COMP%]   module[_ngcontent-%COMP%]   and[_ngcontent-%COMP%]   return[_ngcontent-%COMP%]   exports[_ngcontent-%COMP%]   //[_ngcontent-%COMP%]   This[_ngcontent-%COMP%]   entry[_ngcontent-%COMP%]   module[_ngcontent-%COMP%]   doesn\\\"t[_ngcontent-%COMP%]   tell[_ngcontent-%COMP%]   about[_ngcontent-%COMP%]   it\\\"s[_ngcontent-%COMP%]   top-level[_ngcontent-%COMP%]   declarations[_ngcontent-%COMP%]   so[_ngcontent-%COMP%]   it[_ngcontent-%COMP%]   can't[_ngcontent-%COMP%]   be[_ngcontent-%COMP%]   inlined\\nvar[_ngcontent-%COMP%]   __webpack_exports__[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] {}; __webpack_modules__[966](); resource = __webpack_exports__;})()[_ngcontent-%COMP%]   ;[_ngcontent-%COMP%]{}\"]\n    });\n  }\n  return PunchComponent;\n})();\nexport { PunchComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}